name: acme
http:
  host: http://acme.dalperf.us-south.containers.appdomain.cloud
  sharedConnections: 10
phases:
- login:
    constantPerSec:
      usersPerSec: 1
      duration: 10s
      scenario:
      - login:
        - httpRequest:
            headers:
              Content-Type: "application/x-www-form-urlencoded"
            POST:
              pattern: /auth/login
            body:
              form:
              - name: login
                value: uid22@email.com
              - name: password
                value: password
            handler:
              header:
                - cookie:
                    name: jwt_token
                    toVar: jwtToken
        - log:
            message: jwt_token is {}
            vars : 
            - jwtToken
      - customer:
        - httpRequest:
            headers:
                Authorization:
                  pattern: Bearer ${jwtToken}
            GET:
              pattern: /customer/byid/uid22@email.com
            handler:
              body:
              - defrag:
                  processor:
                    simple:
                      toVar: response
                      format: STRING
        - log:
            message: response is {}
            vars:
            - response

